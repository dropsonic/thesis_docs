\documentclass[oneside,draft,14pt]{extreport}
\usepackage{pdfpages} % поддержка вставки страниц из pdf-файлов
\usepackage[onehalfspacing]{setspace} % 1,5 интервал
\usepackage[a4paper, top=2.0cm,bottom=2.0cm,left=2.0cm,right=1.0cm]{geometry} % поля
\usepackage{pdflscape} % поддержка альбомной ориентации страниц
\usepackage{indentfirst} % красная строка
\setlength\parindent{1.5cm} % установка величины отступа красной строки

\usepackage{etoolbox} % позволяет добавлять произвольный код в начало любой команды, и содержит прочие подобные доп. функции для программирования
\usepackage{suffix} % позволяет легко определять команды со звёздочкой (starred version of command)
\usepackage{afterpage} % float overload fix
\usepackage{placeins} % float barrier
\usepackage{caption} % подписи
\usepackage{subcaption} % подфлоаты во флоатах
\DeclareCaptionLabelSeparator{emdash}{ --- }
\usepackage{csvsimple} % таблицы из csv-файлов
%\usepackage[pages=some]{background}

% Команды для сохранения и вывода информации о работе (автор, руководитель и т.п.)
\makeatletter
\def\thesistitle#1{\gdef\@thesistitle{#1}}
\def\@thesistitle{\@latex@error{No \noexpand\thesistitle given}\@ehc}

\def\superviser#1{\gdef\@superviser{#1}}
\def\@superviser{\@latex@error{No \noexpand\superviser given}\@ehc}

\def\specadviser#1{\gdef\@specadviser{#1}}
\def\@specadviser{\@latex@error{No \noexpand\specadviser given}\@ehc}

\def\specadviser#1{\gdef\@specadviser{#1}}
\def\@specadviser{\@latex@error{No \noexpand\specadviser given}\@ehc}

\def\headofsubfaculty#1{\gdef\@headofsubfaculty{#1}}
\def\@headofsubfaculty{\@latex@error{No \noexpand\headofsubfaculty given}\@ehc}

\def\universityname#1{\gdef\@universityname{#1}}
\def\@universityname{\@latex@error{No \noexpand\universityname given}\@ehc}

\def\specialtynumber#1{\gdef\@specialtynumber{#1}}
\def\@specialtynumber{\@latex@error{No \noexpand\specialtynumber given}\@ehc}

\def\thesisyear#1{\gdef\@thesisyear{#1}}
\def\@thesisyear{\@latex@error{No \noexpand\thesisyear given}\@ehc}

\def\groupnumber#1{\gdef\@groupnumber{#1}}
\def\@groupnumber{\@latex@error{No \noexpand\groupnumber given}\@ehc}

\def\keywords#1{\gdef\@keywords{#1}}
\def\@keywords{\@latex@error{No \noexpand\keywords given}\@ehc}

\newcommand{\thethesistitle}{\@thesistitle}
\newcommand{\thetitle}{\@title}
\newcommand{\theauthor}{\@author}
\newcommand{\thesuperviser}{\@superviser}
\newcommand{\thespecadviser}{\@specadviser}
\newcommand{\theheadofsubfaculty}{\@headofsubfaculty}
\newcommand{\theuniversityname}{\@universityname}
\newcommand{\thespecialtynumber}{\@specialtynumber}
\newcommand{\thethesisyear}{\@thesisyear}
\newcommand{\thegroupnumber}{\@groupnumber}
\newcommand{\thekeywords}{\@keywords}
\makeatother

% Шрифты
\usepackage[cm-default]{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}
%\setromanfont[Mapping=tex-text]{Times New Roman}
\setmainfont[Mapping=tex-text]{Times New Roman}
\setsansfont[Mapping=tex-text]{Calibri}
\newfontfamily{\cyrillicfonttt}{Courier New}
\setmonofont[Mapping=tex-text]{Courier New}
\newfontfamily\GostTypeAFont{Arial} % GOST type A
\newfontfamily\GostTypeBFont{Arial} % GOST type B
\defaultfontfeatures{Scale=MatchLowercase, Mapping=tex-text} % одинаковый рост строчных букв у разных гарнитур, маппинги TeXовских лигатур вроде -- и ---
\usepackage{ulem} % поддержка подчёркиваний

% Поддержка русского языка и русскоязычных стилей
\usepackage{polyglossia}
\setmainlanguage[babelshorthands=true]{russian} % основной язык - русский
\setotherlanguage[variant=us]{english} % дополнительный язык - английский

% Формулы
\usepackage{amsmath}
\usepackage{amstext} % поддержка текста внутри формул
\usepackage{amssymb} % дополнительные символы в математических формулах
%\usepackage{icomma} % запятая в качестве десятичного разделителя
\usepackage{chngcntr} % управление нумерацией
\apptocmd{\subequations}{\renewcommand{\theequation}{\theparentequation\asbuk{equation}}}{}{} % нумерация подформул кириллицей (например, 5а, 5б, 5в и т.д.)
\counterwithout{equation}{chapter} % сквозная нумерация формул
% поддержка кириллицы в формулах (не работает, хотя должно)
%\usepackage{unicode-math}
%\setmathfont[math-style=TeX]{Cambria Math}
%\usepackage[warn]{mathtext}

% Формат заголовков
\usepackage{titlesec}
\setcounter{secnumdepth}{3} % включает нумерацию subsubsection
\newcommand{\nhspacesize}{10pt}
\newcommand{\nohyphenation}{\righthyphenmin62}
\titleformat{\chapter}[hang]{\nohyphenation\sloppy\Large\bfseries}{\thechapter}{\nhspacesize}{} % nohyphenation - не переносить слова в названиях глав
\titleformat{\section}[hang]{\nohyphenation\sloppy\large\bfseries}{\thesection}{\nhspacesize}{}
\titleformat{\subsection}[hang]{\sloppy\normalsize\bfseries}{\thesubsection}{\nhspacesize}{}
\titleformat{\subsubsection}[hang]{\sloppy\normalsize\bfseries}{\thesubsubsection}{\nhspacesize}{}
\titlespacing*{\chapter}{\parindent}{-30pt}{*4}
\titlespacing*{\section}{\parindent}{*4}{*2}
\titlespacing*{\subsection}{\parindent}{*2}{*1}
\titlespacing*{\subsubsection}{\parindent}{*1}{*1}
%\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex} % если вдруг нужен интервал между абзацами

% Новый формат заголовков - специальные разделы (реферат, вступление, заключение и т.п.)
\newcommand{\spchapterStar}[1]{
	\clearpage
	\begin{center}
		\nohyphenation{\sloppy{\textbf{\Large{#1}}}}
	\end{center}
	\par}
\newcommand{\spchapter}[1]{
	\spchapterStar{#1}
	\addcontentsline{toc}{chapter}{#1}}
\WithSuffix\newcommand\spchapter*[1]{\spchapterStar{#1}}

% Формат списков
\usepackage{enumitem}
\setlist{nolistsep} % убрать лишний интервал между элементами списка
\setlist[itemize,1]{label={--}, labelindent=\parindent, leftmargin=*} % маркированные списки: символ - короткое тире, выравнивание символа по красной строке
\AddEnumerateCounter{\asbuk}{\asbuk}{д} % последний параметр - самый широкий символ в перечислении
\setlist[enumerate,1]{label={\asbuk*}), labelindent=\parindent, leftmargin=*}
\setlist[enumerate,2]{label={\arabic*}), leftmargin=\parindent}
\setlist[description]{labelindent=\parindent, leftmargin=0pt, font=\textmd}
\newenvironment{abbreviation}{%
\setlist[description]{labelindent=\parindent, leftmargin=0pt, font=\textbf}
\begin{description}}{\end{description}}

% Поддержка изображений
\usepackage{graphicx}
\graphicspath{{./images/}{./special/images/}{./economics/images/}{./labourprotection/images/}{./appendices/images/}} % пути к каталогам с изображениями
\usepackage{svg} % поддержка вставки векторных (SVG) изображений (из Inkscape) - команда includesvg

% Таблицы
%\usepackage{makecell}
%\usepackage{tabularx}
\usepackage{array} % дополнительные виды столбцов
\usepackage{longtable} % многостраничные таблицы
\usepackage{multirow} % объединение ячеек по вертикали
\usepackage{slashbox} % возможность разделить ячейку диагональной линией

%\newcolumntype{CL}[1]{>{\arraybackslash}m{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash}m{#1}}
%\newcolumntype{CR}[1]{>{\raggedright\arraybackslash}m{#1}}
%\newcolumntype{TL}[1]{>{\arraybackslash}p{#1}}
%\newcolumntype{TC}[1]{>{\centering\arraybackslash}p{#1}
%\newcolumntype{TR}[1]{>{\raggedright\arraybackslash}p{#1}}
%\newcolumntype{BL}[1]{>{\arraybackslash}b{#1}}
%\newcolumntype{BC}[1]{>{\centering\arraybackslash}b{#1}}
%\newcolumntype{BR}[1]{>{\raggedright\arraybackslash}b{#1}}
%\newcommand{\ptw}[1]{#1\linewidth}

\setlength{\extrarowheight}{4pt}
%\renewcommand{\arraystretch}{1.5}
%\newcommand{\tn}{\tabularnewline}
%\newcommand{\tnhl}{\tabularnewline\hline}
%\newcommand{\tncl}[1]{\tabularnewline\cline{#1}}

% Формат рисунков и таблиц
\captionsetup{labelsep=emdash, textformat=simple, figurename=Рисунок, tablename=Таблица, figurewithin=none, tablewithin=none} % разделитель подписи и названия - короткое тире, заголовок - название float'a и номер, имена рисунков и таблиц по ГОСТу, сквозная нумерация рисунков и таблиц
\captionsetup[figure]{position=above}
\captionsetup[table]{singlelinecheck=false, position=top, justification=raggedright}
\renewcommand{\thesubfigure}{\asbuk{subfigure}} % использовать русский алфавит в качестве нумерации подрисунков
\captionsetup[subfigure]{labelformat=brace, font={small}}
% подписи многостраничных таблиц
\newcommand{\LTcontcaption}[1]{\captionsetup{justification=raggedleft, singlelinecheck=false,position=top,font=it}\caption*{Продолжение таблицы~\ref{#1}}}
\newcommand{\LTendcaption}[1]{\captionsetup{justification=raggedleft, singlelinecheck=false,position=top,font=it}\caption*{ Окончание таблицы~\ref{#1}}}
%\DeclareCaptionLabelFormat{continued}{#1~#2 (\textit{продолжение})}
%\captionsetup[ContinuedFloat]{labelformat=continued}
\usepackage{floatrow} % пакет для настройки размещения float'ов и их подписей
\floatsetup[table]{style=plaintop, justification=justified} % название над таблицей, таблица выровнена по ширине влево

% Библиография и библиографические ссылки
\usepackage{cite}
% Замена формата нумерации списка литературы с "[1]" на "1."
\makeatletter
\renewcommand{\@biblabel}[1]{#1.}
\makeatother
\bibliographystyle{utf8gost705u}
\gappto\captionsrussian{\renewcommand{\bibname}{Список использованных источников}}

% Оглавление
\gappto\captionsrussian{\renewcommand{\contentsname}{Содержание}}
\usepackage[subfigure,titles]{tocloft}
\renewcommand{\cftchapleader}{\bfseries\cftdotfill{\cftdotsep}} % точечки не только у глав, но и у всего остального
% расстояние от номера до названия (чтобы номер на название на заезжал)
\setlength{\cftchapnumwidth}{2em}
\setlength{\cftsecnumwidth}{3em}
\setlength{\cftsubsecnumwidth}{4em}

% Подсчёт объектов (для реферата)
\usepackage{totcount}
%\regtotcounter{figure} % рисунки
%\regtotcounter{table} % таблицы
% подсчёт приложений
\newtotcounter{appendixcount}
\usepackage{apptools}
\pretocmd{\chapter}{\IfAppendix{\addtocounter{appendixcount}{1}}{}}{}{}
% подсчёт страниц
\usepackage{lastpage}
\newcommand{\pagecount}{\pageref{LastPage}}
% подсчёт использованных источников
\newtotcounter{refcount}
\pretocmd{\bibitem}{\addtocounter{refcount}{1}}{}{}
% подсчёт рисунков и таблиц
\newtotcounter{figurecount}
\newtotcounter{tablecount}
\AfterEndEnvironment{figure}{\addtocounter{figurecount}{1}}
\AfterEndEnvironment{table}{\addtocounter{tablecount}{1}}
\AfterEndEnvironment{longtable}{\addtocounter{tablecount}{1}}

% Оформление приложений
\usepackage[title, titletoc]{appendix}
% задание своего формата заголовков для приложений
\apptocmd{\appendix}{
	\titleformat{\chapter}[display]{\nohyphenation\sloppy\normalsize\centering}{\MakeUppercase{\chaptertitlename} \thechapter}{\nhspacesize}{\bfseries}{}
	\counterwithin{equation}{chapter}
	\counterwithin{figure}{chapter}
	\counterwithin{table}{chapter}
	\counterwithin{algorithm}{chapter}
}{}{}
\apptocmd{\appendices}{
	\renewcommand{\thechapter}{\Asbuk{chapter}}
	\titlespacing*{\chapter}{\parindent}{-30pt}{*1}
}{}{}

% Псевдокод алгоритмов
\usepackage{algorithm}
\usepackage{algorithmic}
\BeforeBeginEnvironment{algorithm}{\medskip} % оставлять место перед листингом с псевдокодом
\input{algo_russian} % перевод терминов псевдокода на русский
\captionsetup[algorithm]{name = Листинг, labelsep = emdash}
\algsetup{indent=0.5\parindent}

% Листинги с исходным кодом
\usepackage{listings}
\lstloadlanguages{[Sharp]C}
\lstset{language=[Sharp]C,
   morekeywords={yield,var,get,set,from,select,partial},
   breaklines=true,
   basicstyle=\footnotesize\ttfamily}


% Основные надписи
\newcommand{\eskdheight}{287}
\newcommand{\eskdwidth}{200}

\newcommand{\eskdthin}{0.2}
\newcommand{\eskdhalfthin}{0.1}
\newcommand{\eskdthick}{0.8}
\newcommand{\eskdhalfthick}{0.4}

\newcommand{\GostA}[1]{\GostTypeAFont\fontsize{20pt}{10pt}\fontshape{it}\selectfont\rotatebox{90}{#1}}
\newcommand{\GostAsmall}[1]{\GostTypeAFont\fontsize{10pt}{10pt}\fontshape{it}\selectfont\rotatebox{90}{#1}}
\newcommand{\GostB}[1]{\GostTypeBFont\fontsize{9pt}{10pt}\fontshape{it}\selectfont\rotatebox{90}{#1}}
\newcommand{\GostBsmall}[1]{\GostTypeBFont\fontsize{8pt}{10pt}\fontshape{it}\selectfont\rotatebox{90}{#1}}  

\newcommand{\eskdstampbox}{%
	\unitlength 1mm
	\begin{picture}(0,0)(-\eskdwidth,0)
		\linethickness{\eskdthick mm}
		% Рамка
		\put(0,0){\line(-1,0){\eskdwidth}}
		\put(0,-\eskdheight){\line(-1,0){\eskdwidth}}
		\put(0,0){\line(0,-1){\eskdheight}}
		\put(-\eskdwidth,0){\line(0,-1){\eskdheight}}
		% Углы рамки
		\put(\eskdhalfthick,0){\line(-1,0){\eskdhalfthick}}
		\put(\eskdhalfthick,-\eskdheight){\line(-1,0){\eskdhalfthick}}
		\put(-\eskdwidth,0){\line(-1,0){\eskdhalfthick}}
		\put(-\eskdwidth,-\eskdheight){\line(-1,0){\eskdhalfthick}}
		
		% Таблица
		% толстые линии - длинные горизонтальные
		\put(-25,0){\line(0,-1){185}}
		\put(-40,0){\line(0,-1){185}}
		% толстые линии - короткие горизонтальные
		\put(-15,0){\line(0,-1){50}}
		\put(-20,0){\line(0,-1){50}}
		\put(-30,-120){\line(0,-1){65}}
		% тонкие линии - горизонтальные
		\linethickness{\eskdthin mm}
		\multiput(-5,-120)(-5,0){7}{\line(0,-1){65}}
		\linethickness{\eskdthick mm}
		% толстые линии - вертикальные
		\put(0,-185){\line(-1,0){40}}
		\put(-40,-178){\line(1,0){15}}
		\put(0,-168){\line(-1,0){40}}
		\put(0,-145){\line(-1,0){40}}
		\put(0,-130){\line(-1,0){40}}
		\put(0,-120){\line(-1,0){40}}
		\put(0,-50){\line(-1,0){25}}
		\put(-15,-35){\line(-1,0){10}}
		\put(-15,-20){\line(-1,0){10}}
		% тонкие линии - вертикальные
		\linethickness{\eskdthin mm}
		\put(-15,-45){\line(-1,0){5}}
		\put(-15,-40){\line(-1,0){5}}
		\linethickness{\eskdthick mm}
		% Углы таблицы
		\put(-40,-185){\line(-1,0){\eskdhalfthick}}
		
		% Надписи
		% левые мелкие
		\put(-28.5,-184.5){\GostBsmall{Изм.}}
		\put(-28.6,-177){\GostB{Лист}}
		\put(-28.8,-166.5){\GostB{№ докум.}}
		\put(-28.8,-143.5){\GostB{Подп.}}
		\put(-28.6,-129){\GostB{Дата}}
		\put(-23.6,-184){\GostB{Разраб.}}
		\put(-18.6,-184){\GostB{Руковод.}}
		\put(-13.6,-184){\GostB{Консульт.}}
		\put(-3.6,-184){\GostB{Утв.}}
		% правые мелкие
		\put(-23.6,-48.5){\GostB{Лит.}}
		\put(-23.6,-33.5){\GostB{Лист}}
		\put(-23.6,-15.8){\GostB{Листов}}
		% динамические поля
		\put(-23.4,-167){\GostBsmall{\theauthor}}
		\put(-18.4,-167){\GostBsmall{\thesuperviser}}
		\put(-13.4,-167){\GostBsmall{\thespecadviser}}
		\put(-3.4,-167){\GostBsmall{\theheadofsubfaculty}}
		\put(-35,-117){\GostA{\parbox{114mm}{\centering\theuniversityname-\thespecialtynumber-\thethesisyear}}}
		\put(-23,-118){\GostAsmall{\parbox{65mm}{\thethesistitle}}}
		\put(-10,-48){\GostA{\parbox{46mm}{\centering\thegroupnumber}}}
		\put(-18.4,-34){\GostB{\parbox{12.7mm}{\centering\thepage}}}
		\put(-18.4,-19){\GostB{\parbox{17mm}{\centering\pagecount}}}
	\end{picture}
}

\newcommand{\includepresentation}[1]{%
	\newgeometry{top=0cm,bottom=0.6cm,left=0.6cm-\parindent,right=0cm}
	\includepdf[pages=-, pagecommand={%
		\thispagestyle{empty}
		\begin{picture}(0,0)
			\put(0,0){\eskdstampbox}
		\end{picture}
	},landscape,scale=0.65, offset=-1.7cm -0.5cm]{#1}
	\restoregeometry
}

% Информация о работе
\thesistitle{Разработка системы мониторинга ЛА (Integrated System Health Management) на основе методов интеллектуального анализа данных (Data Mining)}
\keywords{контроль состояния, обнаружение аномалий, интеллектуальный анализ данных, Data Mining, кластеризация, Integrated System Health Monitoring, телеметрия}
\author{Панченко В.В.}
\superviser{Пискунов В.А.}
\specadviser{Васильев А.Д.}
\headofsubfaculty{Шаронов А.В.}
\universityname{МАИ}
\specialtynumber{230201}
\thesisyear{2013}
\groupnumber{03-617}

\begin{document}
	\includepdf[pages={1}]{title.pdf} % титульник
	\includepdf[pages={1,2}]{assignment.pdf} % задание
	\setcounter{page}{3} % начать нумерацию страниц с №3
	\include{referat}
	\tableofcontents
	
	\include{index}
	\include{intro}
	\include{./special/special}
	\include{./economics/economics}
	\include{./labourprotection/labourprotection}
	\include{conclusion}
	
	\addcontentsline{toc}{chapter}{\bibname}
	\nocite{*}
	\bibliography{thesis}
	
	\appendix
	\begin{appendices}
		\include{./appendices/gmmscheme}
		\include{./appendices/ims_training_scheme}
		\include{./appendices/ims_monitoring_scheme}
		\include{./appendices/ddms_training_scheme}
		\include{./appendices/ddms_clusterdb_scheme}
		\include{./appendices/ddms_monitoring_scheme}
		\include{./appendices/uml_class_dataoperations}
		\include{./appendices/uml_class_orca}
		\include{./appendices/uml_class_datacleansing}
		\include{./appendices/uml_class_ddms}
		\include{./appendices/app_params}
		\include{./appendices/data}
		\include{./appendices/source_code}
		\include{./appendices/presentation}
	\end{appendices}
\end{document}