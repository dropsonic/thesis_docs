\chapter{Специальная часть}
\section{Постановка задачи}
\label{sec:spec:ProblemDefinition}
Разработать метод мониторинга состояния ЛА на основе методов интеллектуального анализа данных. Реализовать программную систему, использующую данный метод.

Система должна удовлетворять следующим требованиям:
\begin{itemize}
	\item строить модель системы только на основе телеметрии при различных режимах её работы, без априорных данных о предметной области, назначении системы, её составе, конструкции (обучение без учителя);
	\item обладать способностью классифицировать аномалии в работе системы;
	\item в случае, если текущее поведение системы не было представлено в обучающей выборке, давать оператору численную характеристику отклонения системы от номинальных режимов;
	\item обрабатывать большие массивы входных данных (несколько десятков тысяч точек) за конечное время;
	\item учитывать как непрерывные, так и дискретные параметры системы;
	\item не иметь ограничений на закон распределения входных данных;
	\item быть устойчивой к аномалиям в обучающей выборке;
	\item быть устойчивой к отсутствию значений каких-либо параметров во входных данных;
	\item определять состояние системы в режиме реального времени.
\end{itemize}

\section{Анализ существующих методов выявления аномалий без учителя}
На данный момент существует несколько методов, для которых доказана возможность применения их в системах контроля и диагностики ЛА. Такими методами являются Orca, GritBot, GMM (Gaussian Mixture Model), DBN (Dynamic Bayesian Network), One-Class SVM (Support Vector Machine) и IMS (Inductive Monitoring System)~\cite{MartinCompUnsupervisedDetectionMethods}.

\input{./special/subsections/orca}

\input{./special/subsections/gritbot}

\input{./special/subsections/gmm}

\input{./special/subsections/dbn}

\input{./special/subsections/svm}

\input{./special/subsections/ims}

\section{Разработка метода мониторинга состояния ЛА на основе методов интеллектуального анализа данных}

Все описанные выше методы имеют свои недостатки при их применении для диагностики сложных технических систем. Сравнение методов по критериям, указанным в разделе~\ref{sec:spec:ProblemDefinition}, приведено в таблице~\ref{tab:spec:MethodsComparison}.

\begin{table}[h]
\caption{Сравнение методов выявления аномалий без учителя}
\label{tab:spec:MethodsComparison}

\begin{tabular}{|C{210pt}|C{35pt}|C{45pt}|C{38pt}|C{35pt}|C{36pt}|C{35pt}|}
\hline
\backslashbox{Критерий}{Метод} & Orca & GritBot & GMM & DBN & SVM & IMS \\
\hline
Построение модели системы без априорных данных о предметной области, назначении системы, её составе, конструкции & + & + & ± & + & − & + \\
\hline
Классификация аномалий & − & − & − & + & − & − \\
\hline
Численная характеристика аномалии & + & − & − & − & + & + \\
\hline
Обработка больших выборок за конечное время & ± & − & ± & + & + & + \\
\hline
Работа с дискретными параметрами & + & + & − & ± & − & − \\
\hline
Отсутствие ограничений на закон распределения входных данных & + & + & − & ± & + & + \\
\hline
Устойчивость к аномалиям в обучающей выборке & + & + & − & − & − & − \\
\hline
Устойчивость к отсутствию значений параметров во входных данных & + & + & − & − & − & + \\
\hline
Работа в режиме реального времени & − & − & + & + & + & + \\
\hline
\end{tabular}
\end{table}

По результатам сравнения наиболее подходящим является метод IMS, описанный в пункте~\ref{subsec:spec:IMS}. Так как он не удовлетворяет всем требованиям, указанным в разделе~\ref{sec:spec:ProblemDefinition}, необходимо создать на его основе метод, устойчивый к аномалиям в обучающей выборке, обеспечивающий возможность классификации аномалий и работающий не только с непрерывными, но и с дискретными параметрами.

\subsection{Формальная постановка задачи мониторинга системы}
Введём следующие обозначения:
\begin{description}
	\item[$M$]~---~дискретно-непрерывное пространство, имеющее $p$ непрерывных и $q$ дискретных измерений;
	\item[$R=\left\{R_1,R_2,\dots,R_n\right\} \in M$]~---~множество режимов работы системы;
	\item[$T=\left\{x_1,x_2,\dots,x_m\right\} \in M$]~---~обучающая выборка;
	\item[$x=\left\{a_1,a_2,\dots,a_p,b_1,b_2,\dots,b_q\right\} \in M, a_i\in\mathbb{R}, b_i\in\mathbb{N}$]~---~элемент обучающей выборки;
	\item[$\theta=\left\{\tilde{a}_1,\tilde{a}_2,\dots,\tilde{a}_p,\tilde{b}_1,\tilde{b}_2,\dots,\tilde{b}_q\right\} \in M, \tilde{a}_i\in\mathbb{R}, \tilde{b}_i\in\mathbb{N}$]~---~входной вектор;
	\item[$\Omega=\left\{\omega_1,\omega_2,\dots,\omega_{p+q}\right\}$]~---~вектор весов.
\end{description}

Необходимо отметить, что некоторые значения в векторах могут отсутствовать.
%\subsubsection{Определения}

Даны $n$ обучающих выборок $T_1\in R_1, T_2\in R_2,\dots, T_n\in R_n$ различной длины, содержащие $m_i$ элементов каждая, где $i$~---~номер режима работы системы. Дан вектор $\Omega$, содержащий веса, соответствующие важности каждого параметра системы. Дан входной вектор $\theta$.

Необходимо определить, принадлежит ли $\theta$ к $R$; если $\theta \in R$, то определить, в каком именно подмножестве $R_i\in R$ находится $\theta$. Если же $\theta \notin R$, найти численную меру $\lambda \in \mathbb{R}_{\geq 0}$, показывающую отклонение $\theta$ от $R$.

\subsection{Общая структура метода}
Предложенный ниже метод относится к методам, основанным на измерении расстояний между точками (distance-based). Поэтому для работы метода необходимо определить взвешенную метрику $d(x,y,\Omega)$ на пространстве $M$. В качестве такой метрики может выступать комбинация Евклидова расстояния~\eqref{eq:spec:DDMS:EuclidDistance} для непрерывных и функции отличия~\eqref{eq:spec:DDMS:DiffDistance} для дискретных переменных. Подобная метрика, определённая на пространстве $M$, показана в формуле~\eqref{eq:spec:DDMS:Distance}. В случае отсутствия значения прибавляется только вес данного параметра.

\begin{subequations}
\begin{equation} \label{eq:spec:DDMS:EuclidDistance}
D_E(x,y) = \sqrt{\sum_{i=1}^{n} \left(x_i - y_i\right)^2}
\end{equation}
\begin{equation} \label{eq:spec:DDMS:DiffDistance}
D_{diff}(x,y) = 
\begin{cases} 
	0, & x=y \text{,} \\
	1, & x\neq y \\
\end{cases}
\end{equation}
\end{subequations}

\begin{equation} \label{eq:spec:DDMS:Distance}
d(x,y,\Omega) = \sqrt{\sum_{i=1}^{p} \left[\omega_i \left(a_i^{(x)} - a_i^{(y)}\right)^2\right]} + \sum_{j=1}^{q} 
\left[\begin{cases} 
	0, & b_j^{(x)}=b_j^{(y)} \text{,} \\
	\omega_j, & b_j^{(x)}\neq b_j^{(y)} \\
\end{cases}\right]
\end{equation}

Блок-схема процесса обучения метода представлена в приложении~\ref{app:DDMS:TrainingScheme}.

Обучение метода проходит в два этапа: подготовка данных и формирование базы режимов.

\subsubsection{Подготовка данных}
Так как элементы в векторах могут иметь различный масштаб, для корректного определения расстояния между двумя точками непрерывные значения векторов сначала необходимо нормализовать. Для этого может применяться как минимаксная нормализация~\eqref{eq:spec:DDMS:MinimaxNormalization}, так и нормализация с помощью стандартного отклонения~\eqref{eq:spec:DDMS:StandardNormalization}.

\begin{subequations}
\begin{equation} \label{eq:spec:DDMS:MinimaxNormalization}
\hat{x} = \frac{x - \min(X)}{\max(X) - \min(X)}, x\in X
\end{equation}
\begin{equation} \label{eq:spec:DDMS:StandardNormalization}
\hat{x} = \frac{x - \bar{x}}{\sigma_x} \text{,}
\end{equation}
\end{subequations}
\begin{description}
	\item[где $\bar{x}$]~---~среднее значение;
	\item[$\sigma_x$]~---~стандартное отклонение.
\end{description}

Зачастую в обучающих выборках могут содержаться аномальные элементы (сбой в работе датчика, искажения в канале связи и т.д.). Для того, чтобы метод мог корректно обучаться, необходимо их исключить. Для этого на каждой выборке используется алгоритм Orca, описанный в пункте~\ref{subsec:spec:Orca}. В качестве количества аномалий, которые необходимо найти, ему задаётся число элементов в выборке. С учётом этой особенности на выходе данный алгоритм выдаёт численную меру (степень) аномальности для каждого вектора. Далее применяется фильтр, который на основе этой численной меры для каждого вектора определяет, является ли вектор аномальным. Для этого могут использоваться как статистические (например, Гауссовый фильтр, считающий аномальными все векторы, численная мера для которых не укладывается в диапазон $[0, 3\sigma]$), так и пороговые фильтры (считающие аномальными векторы, численная мера которых выше определённой величины $\delta$). Выбранные фильтром аномалии удаляются из выборки.

Результатом данного этапа являются нормализованные выборки, не содержащие аномалий.

\subsubsection{Формирование базы режимов}
На данном этапе производится создание отдельной базы кластеров для каждого режима работы системы.