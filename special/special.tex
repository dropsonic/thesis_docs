\chapter{Специальная часть}
\section{Постановка задачи}
\label{sec:spec:ProblemDefinition}
Разработать метод мониторинга состояния ЛА по данным телеметрии на основе методов интеллектуального анализа данных. Реализовать программную систему для ПЭВМ, использующую данный метод.

Система должна удовлетворять следующим требованиям:
\begin{itemize}
	\item строить модель системы только на основе телеметрии при различных режимах её работы, без априорных данных о предметной области, назначении системы, её составе, конструкции (обучение без учителя);
	\item обладать способностью классифицировать аномалии в работе системы;
	\item в случае, если текущее поведение системы не было представлено в обучающей выборке, давать оператору численную характеристику отклонения системы от номинальных режимов;
	\item обрабатывать большие массивы входных данных (несколько десятков тысяч точек) за конечное время;
	\item учитывать как непрерывные, так и дискретные параметры системы;
	\item не иметь ограничений на закон распределения входных данных;
	\item быть устойчивой к аномалиям в обучающей выборке;
	\item быть устойчивой к отсутствию значений каких-либо параметров во входных данных;
	\item определять состояние системы в режиме реального времени.
\end{itemize}

\section{Анализ существующих методов выявления аномалий без учителя}
На данный момент существует несколько методов, для которых доказана возможность применения их в системах контроля и диагностики ЛА. Такими методами являются Orca, GritBot, модель гауссовых смесей (Gaussian Mixture Model, GMM), динамические байесовские сети (Dynamic Bayesian Network, DBN), одноклассовый метод опорных векторов (One-Class Support Vector Machine, SVM) и IMS (Inductive Monitoring System)~\cite{MartinCompUnsupervisedDetectionMethods}.

\input{./special/subsections/orca}

\input{./special/subsections/gritbot}

\input{./special/subsections/gmm}

\input{./special/subsections/dbn}

\input{./special/subsections/svm}

\input{./special/subsections/ims}

\section{Разработка метода мониторинга состояния ЛА на основе методов интеллектуального анализа данных}

Все описанные выше методы имеют свои недостатки при их применении для диагностики сложных технических систем. Сравнение методов по критериям, указанным в разделе~\ref{sec:spec:ProblemDefinition}, приведено в таблице~\ref{tab:spec:MethodsComparison}.

\begin{table}[h]
\caption{Сравнение методов выявления аномалий без учителя}
\label{tab:spec:MethodsComparison}

\begin{tabular}{|C{210pt}|C{35pt}|C{45pt}|C{38pt}|C{35pt}|C{36pt}|C{35pt}|}
\hline
\backslashbox{Критерий}{Метод} & Orca & GritBot & GMM & DBN & SVM & IMS \\
\hline
Построение модели системы без априорных данных о предметной области, назначении системы, её составе, конструкции & + & + & ± & + & − & + \\
\hline
Классификация аномалий & − & − & − & + & − & − \\
\hline
Численная характеристика аномалии & + & − & − & − & + & + \\
\hline
Обработка больших выборок за конечное время & ± & − & ± & + & + & + \\
\hline
Работа с дискретными параметрами & + & + & − & ± & − & − \\
\hline
Отсутствие ограничений на закон распределения входных данных & + & + & − & ± & + & + \\
\hline
Устойчивость к аномалиям в обучающей выборке & + & + & − & − & − & − \\
\hline
Устойчивость к отсутствию значений параметров во входных данных & + & + & − & − & − & + \\
\hline
Работа в режиме реального времени & − & − & + & + & + & + \\
\hline
\end{tabular}
\end{table}

По результатам сравнения наиболее подходящим является метод IMS, описанный в подразделе~\ref{subsec:spec:IMS}. Так как он не удовлетворяет всем требованиям, указанным в разделе~\ref{sec:spec:ProblemDefinition}, необходимо создать на его основе метод, устойчивый к аномалиям в обучающей выборке, обеспечивающий возможность классификации аномалий и работающий не только с непрерывными, но и с дискретными параметрами.

\input{./special/subsections/ddms}

\section{Выбор программных средств реализации метода}

К языку программирования и программной платформе в данной работе предъявлялись следующие требования:
\begin{itemize}
	\item поддержка объектно-ориентированной парадигмы;
	\item удобство использования (скорость разработки);
	\item возможность повторного использования кода;
	\item быстродействие.
\end{itemize}

Рассмотрим подробнее каждое из требований.

\input{./special/subsections/demands}

\input{./special/subsections/languages}

\input{./special/subsections/languages_choice}

\section{Разработка программной реализации метода}
Программная реализация была разработана на языке программирование C\# 5.0 с использованием фреймворка .NET 4.5 в среде Microsoft Visual Studio 2013. Система разработана таким образом, чтобы обеспечить универсальность и лёгкость интеграции в другие смежные системы, позволить повторное использование отдельных модулей. Она имеет текстовый (консольный) интерфейс в соответствии с философией UNIX для возможности использования из других программных систем. Исходный код приведён в приложении~\ref{app:SourceCode}.

\input{./special/subsections/architecture}

\input{./special/subsections/manual}

\section{Тестирование системы и анализ результатов}
Тестирование системы производилось на основе реальных данных телеметрии гиросилового комплекса управления Международной Космической Станции (МКС), собранных за период времени из~\cite{ISSLiveCMGConsole}. Важным фактом является то, что система, подобная разрабатываемой, уже применяется NASA для контроля и диагностики данной части МКС~\cite{IversonSHMforSpaceMissionOperations}.

Гиросиловой комплекс управления показан на рисунке~\ref{fig:spec:results:ISSCMGSystem}. Он состоит из четырёх гироскопов с управляющим моментом (гиродинов).

\begin{figure}[h]
\includegraphics{iss_cmg_system}
\caption{Гиросиловой комплекс управления МКС}
\label{fig:spec:results:ISSCMGSystem}
\end{figure}

Так как характеристики гиродинов отличаются в зависимости от экземпляра~\cite{IversonSHMforSpaceMissionOperations}, контроль и диагностика с помощью методов интеллектуального анализа данных должна производиться для каждого гиродина по отдельности. Измеряемые параметры гиродина представлены в таблице~\ref{tab:spec:results:CMGParams}. Соответствующий им файл описания параметров представлен в листинге~\ref{lst:spec:results:params}.

\begin{table}[h]
\caption{Измеряемые параметры гиродина}
\label{tab:spec:results:CMGParams}
\begin{tabular}{|C{70pt}|C{250pt}|C{100pt}|}
\hline
Параметр & Описание & Единица измерения \\
\hline
$T$ & Дата и время измерения & дд/чч:мм:сс \\
\hline
$S$ & Состояние (используется/выключен из комплекса) & --  \\
\hline
$\omega$ & Скорость вращения ротора & об/мин \\
\hline
$I$ & Ток, потребляемый двигателем ротора & A \\
\hline
$a$ & Вибрация & g м/с\textsuperscript{2} \\
\hline
$t_b$ & Температура на креплении ротора & \textdegree C \\
\hline
$t_h$ & Температура на датчике скорости вращения & \textdegree C \\
\hline
\end{tabular}
\end{table}

\begin{algorithm}[h]
\caption{Файл с описанием параметров}
\label{lst:spec:results:params}
\raggedright
\addtolength{\leftskip}{5mm}
\smallskip
Дата и время : ignore \\
Состояние : IN USE, DISABLED \\
Скорость вращения ротора : continuous \\
Потребляемый двигателем ротора ток : continuous \\
Вибрация : continuous \\
Температура на креплении ротора : continuous \\
Температура на датчике скорости вращения : continuous \\
\end{algorithm}

Тестирование проводилось для четырёх известных режимов работы: двух штатных и двух внештатных. Данные по внештатным режимам взяты из~\cite{ISSCMGFailureAnalysis}~и~\cite{ISSCMGLessonsLearned}. Для удобства отображения данных для каждого режима было взято только 50 измерений. Для режима, когда гиродин выключен из комплекса, скорость вращения, вибрация и потребляемый ток равны нулю. Обучающие выборки приведены в приложении~\ref{app:Data}.

Штатные режимы:
\begin{itemize}
	\item номинальный (\textit{Nominal});
	\item гиродин выключен из комплекса (\textit{Disabled}).
\end{itemize}

Внештатные режимы:
\begin{itemize}
	\item нестабильность ретейнера ротора (\textit{Retainer instability});
	\item утечка смазки (\textit{Lubrication starvation}).
\end{itemize}

Графики изменения параметров для всех режимов показаны на рисунках~\ref{fig:spec:results:wheelspeed}--\ref{fig:spec:results:halltemp}. Как видно из графиков, в обучающей выборке для номинального режима присутствует аномалия измерения (запись №14).

\begin{figure}[h]
\includegraphics[width=0.7\textwidth]{results_wheelspeed}
\caption{Скорость вращения ротора для всех режимов работы гиродина}
\label{fig:spec:results:wheelspeed}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.7\textwidth]{results_wheelspeed}
\caption{Потребляемый двигателем ротора ток для всех режимов работы гиродина}
\label{fig:spec:results:current}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.7\textwidth]{results_vibration}
\caption{Вибрация для всех режимов работы гиродина}
\label{fig:spec:results:vibration}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.7\textwidth]{results_wheeltemp}
\caption{Температура на креплении ротора для всех режимов работы гиродина}
\label{fig:spec:results:wheeltemp}
\end{figure}

\begin{figure}[h]
\includegraphics[width=0.7\textwidth]{results_halltemp}
\caption{Температура на датчике скорости вращения ротора для всех режимов работы гиродина}
\label{fig:spec:results:halltemp}
\end{figure}

Данные были загружены в систему. Использовались следующие настройки: пороговое значение $\varepsilon=0.05$, минимаксная нормализация, метрика расстояния по формуле~\eqref{eq:spec:DDMS:Distance}, расстояние до ближайшей точки кластера. Система корректно нашла аномалию в обучающей выборке для номинального режима работы (запись №14) и сформировала кластеры.

\begin{figure}
\caption{Модель системы (номинальный режим работы)}
\label{fig:spec:results:scr:nominal}
\includegraphics[width=0.6\textwidth]{results_scr_nominal}
\end{figure}

\begin{figure}
\caption{Модель системы (гиродин выключен из комплекса)}
\label{fig:spec:results:scr:disabled}
\includegraphics[height=0.6\textheight]{results_scr_disabled}
\end{figure}

\begin{figure}
\caption{Модель системы (внештатные режимы)}
\label{fig:spec:results:scr:lubrret}
\includegraphics[width=0.5\textwidth]{results_scr_lubrret}
\end{figure}

Для проверки было взято несколько измерений, как относящихся к указанным режимам, так и заведомо аномальных (таблица~\ref{tab:spec:results:input}), и введены в систему. Результаты показаны на рисунке~\ref{fig:spec:results:monitoring}. Система не только верно определила состояние гиродина, но и показала степень отклонения и ближайший режим для аномальных измерений. Полученные результаты совпали с ожидаемыми.

Так как для обучения системы предполагается использовать большие массивы данных, был проведён нагрузочный тест. В качестве обучающей выборки для номинального режима были взяты данные телеметрии 335 дня с 18:17:16 по 20:37:57 и 338 дня с 13:42:23 по 19:50:00, вместе составляющие объём в 8437 записей. Время обработки данных составило 5 секунд, по результатам обучения система нашла 3 аномалии и создала 3 кластера для номинального режима работы. Результат показан на рисунке~\ref{fig:spec:results:scr:nominalFull}.

Таким образом, тестирование системы успешно завершено.

\begin{table}
\caption{Проверочные данные}
\label{tab:spec:results:input}
\begin{tabular}{|C{80pt}|C{50pt}|C{50pt}|C{50pt}|C{50pt}|C{50pt}|C{100pt}|}
\hline
$S$ & $\omega$ & $I$ & $a$ & $t_b$ & $t_h$ & Режим \\
\hline
IN USE & 6605 & 0.42 & 0.012 & 34.9 & 29 & Номинальный \\
\hline
DISABLED & 0 & 0 & 0 & 23 & 19 & Выключен из комплекса \\
\hline
IN USE & 6500 & 0.4 & 0.013 & 34.9 & 29 & Нестабильность ретейнера ротора \\
\hline
IN USE & 6590 & 0.55 & 0.015 & 37 & 29 & Утечка смазки \\
\hline
IN USE & 6500 & 0.6 & 0.02 & 42 & 31 & Аномалия \\
\hline
IN USE & 6601 & 0.42 & 0.012 & 24 & 10 & Аномалия \\
\hline
DISABLED & 6600 & 0.42 & 0.01 & 19 & 7 & Аномалия \\
\hline
\end{tabular}
\end{table}

\begin{figure}
\caption{Результаты мониторинга состояния системы}
\label{fig:spec:results:monitoring}
\includegraphics[width=0.7\textwidth]{results_monitoring}
\end{figure}

\begin{figure}
\caption{Результаты обучения системы на реальных данных}
\label{fig:spec:results:scr:nominalFull}
\includegraphics[width=0.7\textwidth]{results_scr_nominalFull}
\end{figure}